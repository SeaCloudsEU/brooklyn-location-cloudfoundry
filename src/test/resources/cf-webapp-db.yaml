name: CF - appserver-w-db
services:
- type: brooklyn.entity.cloudfoundry.webapp.java.JavaCloudFoundryPaasWebApp
  name: AppServer HelloWorld 
  id: webapp
  location: cloudfoundry-instance
  brooklyn.config:
    application-name: test-brooklyn-service-mysql-from-yaml
    application-path: classpath://brooklyn-example-hello-world-webapp.war
    bind: 
    - $brooklyn:component("db")
    env: 
      myDbJdbcUrl: $brooklyn:component("db").attributeWhenReady("test-brooklyn-service-mysql-from-yaml.credentials.jdbcUrl")
      myDbName: $brooklyn:component("db").attributeWhenReady("test-brooklyn-service-mysql-from-yaml.credentials.name")

- type: brooklyn.entity.cloudfoundry.services.sql.cleardb.ClearDbService
  id: db
  name: DB HelloWorld Visitors
  location: cloudfoundry-instance
  brooklyn.config:
    creationScriptUrl: classpath://chat-database.sql
    serviceInstanceName: test-brooklyn-service-mysql-from-yaml
    plan: spark